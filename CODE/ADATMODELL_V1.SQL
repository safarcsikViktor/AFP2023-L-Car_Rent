-- Generated by Oracle SQL Developer Data Modeler 22.2.0.165.1149
--   at:        2023-04-20 19:08:17 CEST
--   site:      Oracle Database 11g
--   type:      Oracle Database 11g



-- predefined type, no DDL - MDSYS.SDO_GEOMETRY

-- predefined type, no DDL - XMLTYPE

CREATE TABLE admin (
    admin_id              NUMBER NOT NULL,
    profile_id            NUMBER,
    permission_type       VARCHAR2(10),
    permission_start_date DATE,
    permission_end_date   DATE,
    employee_id           NUMBER
);

ALTER TABLE admin ADD CONSTRAINT admin_pk PRIMARY KEY ( admin_id );

CREATE TABLE car (
    car_id NUMBER NOT NULL,
    status CHAR(1) NOT NULL,
    photo  BLOB
);

ALTER TABLE car ADD CONSTRAINT car_pk PRIMARY KEY ( car_id );

CREATE TABLE car_category (
    car_category             VARCHAR2(2) NOT NULL,
    car_category_description VARCHAR2(150)
);

COMMENT ON COLUMN car_category.car_category IS
    'Gépjármű típusa (B, P, ...)';

ALTER TABLE car_category ADD CONSTRAINT car_category_pk PRIMARY KEY ( car_category );

CREATE TABLE car_description (
    car_id             NUMBER NOT NULL,
    manufacturing_year NUMBER,
    car_description    VARCHAR2(150),
    car_category       VARCHAR2(2) NOT NULL,
    transmission_type  VARCHAR2(2) NOT NULL,
    fuel_type          CHAR(1) NOT NULL,
    engine_power       NUMBER,
    air_conditining    VARCHAR2(1),
    gps                VARCHAR2(1),
    number_of_doors    NUMBER,
    number_of_seats    NUMBER,
    packages           VARCHAR2(20),
    rental_fee         NUMBER
);

COMMENT ON COLUMN car_description.manufacturing_year IS
    'Gyártási év';

COMMENT ON COLUMN car_description.car_description IS
    'Gépjármű típusának leírása';

COMMENT ON COLUMN car_description.engine_power IS
    'Motor teljesítménye';

COMMENT ON COLUMN car_description.number_of_doors IS
    'Ajtók száma';

ALTER TABLE car_description ADD CONSTRAINT car_description_pk PRIMARY KEY ( car_id );

CREATE TABLE car_status (
    status_id          CHAR(1) NOT NULL,
    status_description VARCHAR2(100)
);

ALTER TABLE car_status ADD CONSTRAINT car_status_pk PRIMARY KEY ( status_id );

CREATE TABLE employee (
    employee_id NUMBER NOT NULL,
    first_name  NVARCHAR2(100),
    last_name   NVARCHAR2(100),
    work_since  DATE,
    work_until  DATE
);

ALTER TABLE employee ADD CONSTRAINT employee_pk PRIMARY KEY ( employee_id );

CREATE TABLE fuel_type (
    fuel_type_id          CHAR(1) NOT NULL,
    fuel_type_description VARCHAR2(150)
);

COMMENT ON COLUMN fuel_type.fuel_type_id IS
    'Üzemeanyagtípus (benzin, dízel, hibrid, elektromos)';

ALTER TABLE fuel_type ADD CONSTRAINT fuel_type_pk PRIMARY KEY ( fuel_type_id );

CREATE TABLE history (
    car_id      NUMBER NOT NULL,
    date_from   DATE NOT NULL,
    date_to     DATE,
    contract_id VARCHAR2(20) NOT NULL,
    incident_id NUMBER
);

ALTER TABLE history ADD CONSTRAINT history_pk PRIMARY KEY ( car_id,
                                                            date_from );

CREATE TABLE incidents (
    incident_id          NUMBER NOT NULL,
    car_id               NUMBER NOT NULL,
    incident_description VARCHAR2(500),
    contract_id          VARCHAR2(20),
    damage_value         NUMBER
);

COMMENT ON COLUMN incidents.incident_description IS
    'Káresemény leírása';

COMMENT ON COLUMN incidents.damage_value IS
    'Káresemény mértéke';

ALTER TABLE incidents ADD CONSTRAINT incidents_pk PRIMARY KEY ( incident_id );

CREATE TABLE profile (
    profile_id           NUMBER NOT NULL,
    user_name            VARCHAR2(100),
    email_address        VARCHAR2(100),
    phone_number         VARCHAR2(100),
    date_of_registration DATE,
    status               VARCHAR2(5),
    pwd                  VARCHAR2(500),
    city                 VARCHAR2(150),
    postcode             VARCHAR2(15),
    street               VARCHAR2(200),
    date_of_birth        DATE,
    first_name           VARCHAR2(100),
    last_name            VARCHAR2(100)
);

ALTER TABLE profile ADD CONSTRAINT profile_pk PRIMARY KEY ( profile_id );

CREATE TABLE profile_x_contract_x_car (
    profile_id  NUMBER NOT NULL,
    car_id      NUMBER NOT NULL,
    contract_id VARCHAR2(20) NOT NULL
);

ALTER TABLE profile_x_contract_x_car ADD CONSTRAINT profile_x_contract_x_car_pk PRIMARY KEY ( profile_id,
                                                                                              contract_id );

CREATE TABLE transmission (
    transmission_type_id          VARCHAR2(2) NOT NULL,
    transmission_type_description VARCHAR2(150)
);

COMMENT ON COLUMN transmission.transmission_type_description IS
    'Sebességváltó fajta (automata, kézi)';

ALTER TABLE transmission ADD CONSTRAINT transmission_pk PRIMARY KEY ( transmission_type_id );

ALTER TABLE admin
    ADD CONSTRAINT admin_employee_fk FOREIGN KEY ( profile_id )
        REFERENCES employee ( employee_id );

ALTER TABLE admin
    ADD CONSTRAINT admin_profile_fk FOREIGN KEY ( profile_id )
        REFERENCES profile ( profile_id );

ALTER TABLE car_description
    ADD CONSTRAINT car_desc_car_category_fk FOREIGN KEY ( car_category )
        REFERENCES car_category ( car_category );

ALTER TABLE car_description
    ADD CONSTRAINT car_desc_car_fk FOREIGN KEY ( car_id )
        REFERENCES car ( car_id );

ALTER TABLE car_description
    ADD CONSTRAINT car_desc_fuel_type_fk FOREIGN KEY ( fuel_type )
        REFERENCES fuel_type ( fuel_type_id );

ALTER TABLE car_description
    ADD CONSTRAINT car_desc_transmission_fk FOREIGN KEY ( transmission_type )
        REFERENCES transmission ( transmission_type_id );

ALTER TABLE car
    ADD CONSTRAINT car_status_fk FOREIGN KEY ( status )
        REFERENCES car_status ( status_id );

ALTER TABLE history
    ADD CONSTRAINT history_car_fk FOREIGN KEY ( car_id )
        REFERENCES car ( car_id );

ALTER TABLE incidents
    ADD CONSTRAINT incident_car_fk FOREIGN KEY ( car_id )
        REFERENCES car ( car_id );

ALTER TABLE profile_x_contract_x_car
    ADD CONSTRAINT pcc_car_fk FOREIGN KEY ( car_id )
        REFERENCES car ( car_id );

ALTER TABLE profile_x_contract_x_car
    ADD CONSTRAINT pcc_profile_fk FOREIGN KEY ( profile_id )
        REFERENCES profile ( profile_id );



-- Oracle SQL Developer Data Modeler Summary Report: 
-- 
-- CREATE TABLE                            12
-- CREATE INDEX                             0
-- ALTER TABLE                             23
-- CREATE VIEW                              0
-- ALTER VIEW                               0
-- CREATE PACKAGE                           0
-- CREATE PACKAGE BODY                      0
-- CREATE PROCEDURE                         0
-- CREATE FUNCTION                          0
-- CREATE TRIGGER                           0
-- ALTER TRIGGER                            0
-- CREATE COLLECTION TYPE                   0
-- CREATE STRUCTURED TYPE                   0
-- CREATE STRUCTURED TYPE BODY              0
-- CREATE CLUSTER                           0
-- CREATE CONTEXT                           0
-- CREATE DATABASE                          0
-- CREATE DIMENSION                         0
-- CREATE DIRECTORY                         0
-- CREATE DISK GROUP                        0
-- CREATE ROLE                              0
-- CREATE ROLLBACK SEGMENT                  0
-- CREATE SEQUENCE                          0
-- CREATE MATERIALIZED VIEW                 0
-- CREATE MATERIALIZED VIEW LOG             0
-- CREATE SYNONYM                           0
-- CREATE TABLESPACE                        0
-- CREATE USER                              0
-- 
-- DROP TABLESPACE                          0
-- DROP DATABASE                            0
-- 
-- REDACTION POLICY                         0
-- 
-- ORDS DROP SCHEMA                         0
-- ORDS ENABLE SCHEMA                       0
-- ORDS ENABLE OBJECT                       0
-- 
-- ERRORS                                   0
-- WARNINGS                                 0
